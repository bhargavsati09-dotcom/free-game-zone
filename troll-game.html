<!DOCTYPE html>
<html>
<head>
  <title>Troll Platform Game</title>
  <style>
    body {
      margin: 0;
      background: #0b0f2a;
      overflow: hidden;
      font-family: Arial;
      color: white;
      text-align: center;
    }
    canvas {
      background: #1a1f4a;
      display: block;
      margin: auto;
    }
  </style>
</head>
<body>

<h2>Troll Platform Game ðŸ˜ˆ</h2>
<p>Arrow keys to move â€¢ Reach the yellow block</p>

<canvas id="game" width="600" height="350"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let player = { x: 50, y: 250, w: 20, h: 20, vy: 0, onGround: false };

let gravity = 0.6;
let jumpPower = -13; // stronger jump

let win = false;

// platforms
let platforms = [
  {x:0, y:300, w:600, h:50},       // ground
  {x:120, y:240, w:80, h:10},
  {x:250, y:200, w:80, h:10, fake:true}, // FAKE disappears
  {x:380, y:170, w:80, h:10},
];

// spikes
let spikes = [
  {x:200, y:290, w:20, h:10},
  {x:220, y:290, w:20, h:10},
  {x:420, y:160, w:20, h:10, hidden:true} // hidden trap
];

// goal
let goal = {x:520, y:140, w:25, h:25};

let keys = {};

document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

function reset() {
  player.x = 50;
  player.y = 250;
  player.vy = 0;
}

function update() {
  if (win) return;

  // movement
  if (keys["ArrowLeft"]) player.x -= 3;
  if (keys["ArrowRight"]) player.x += 3;

  // jump
  if (keys["ArrowUp"] && player.onGround) {
    player.vy = jumpPower;
    player.onGround = false;
  }

  // gravity
  player.vy += gravity;
  player.y += player.vy;

  // platform collision
  player.onGround = false;
  platforms.forEach(p => {

    // FAKE platform disappears
    if (p.fake && player.x > p.x && player.x < p.x + p.w) return;

    if (
      player.x < p.x + p.w &&
      player.x + player.w > p.x &&
      player.y < p.y + p.h &&
      player.y + player.h > p.y
    ) {
      player.y = p.y - player.h;
      player.vy = 0;
      player.onGround = true;
    }
  });

  // spike collision
  spikes.forEach(s => {

    // hidden spike appears when near
    if (s.hidden && player.x < 380) return;

    if (
      player.x < s.x + s.w &&
      player.x + player.w > s.x &&
      player.y < s.y + s.h &&
      player.y + player.h > s.y
    ) {
      reset();
    }
  });

  // win check
  if (
    player.x < goal.x + goal.w &&
    player.x + player.w > goal.x &&
    player.y < goal.y + goal.h &&
    player.y + player.h > goal.y
  ) {
    win = true;
  }
}

function draw() {
  ctx.clearRect(0,0,600,350);

  // player
  ctx.fillStyle = "lime";
  ctx.fillRect(player.x, player.y, player.w, player.h);

  // platforms
  ctx.fillStyle = "cyan";
  platforms.forEach(p => {
    if (p.fake && player.x > p.x && player.x < p.x + p.w) return;
    ctx.fillRect(p.x, p.y, p.w, p.h);
  });

  // spikes
  ctx.fillStyle = "red";
  spikes.forEach(s => {
    if (s.hidden && player.x < 380) return;
    ctx.fillRect(s.x, s.y, s.w, s.h);
  });

  // goal
  ctx.fillStyle = "yellow";
  ctx.fillRect(goal.x, goal.y, goal.w, goal.h);

  // win text
  if (win) {
    ctx.fillStyle = "white";
    ctx.font = "30px Arial";
    ctx.fillText("YOU WIN ðŸ˜Ž", 220, 160);
  }
}

function gameLoop() {
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

gameLoop();
</script>

</body>
</html>
