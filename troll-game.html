<!DOCTYPE html>
<html>
<head>
  <title>Time Traveller Troll Game</title>
  <style>
    body { margin:0; overflow:hidden; background:black; color:white; font-family:Arial; }
    #ui { position:fixed; top:10px; left:10px; font-size:18px; }
    canvas { display:block; }
  </style>
</head>
<body>

<div id="ui">
Level: <span id="level">1</span> |
Deaths: <span id="deaths">0</span> |
Time: <span id="time">0.0</span>s
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* ---------- FULLSCREEN ---------- */
function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

/* ---------- GAME STATE ---------- */
let deaths = 0;
let firstDeath = false;
let laughTimer = 0;
let win = false;
let startTime = Date.now();

/* ---------- PLAYER ---------- */
let player = { x:120, y:0, w:28, h:34, vx:0, vy:0 };
const gravity = 0.7;
const jumpPower = -15;

function resetPlayer(){
  player.x = 120;
  player.y = canvas.height - 260; // spawn ON first platform

  player.vx = 0;
  player.vy = 0;
}
resetPlayer();

/* ---------- INPUT ---------- */
let keys = {};
addEventListener("keydown", e=>keys[e.key]=true);
addEventListener("keyup", e=>keys[e.key]=false);

/* ---------- PLATFORMS ---------- */
let platforms = [
  {x:80,  y:canvas.height-180, w:160, h:16},
  {x:320, y:canvas.height-260, w:140, h:16},
  {x:560, y:canvas.height-340, w:140, h:16},
  {x:820, y:canvas.height-420, w:140, h:16}
];

/* disappearing fake platform */
let fakePlatform = {x:450, y:canvas.height-120, w:120, h:16, active:true};

/* sudden appearing platform */
let trollPlatform = {x:700, y:canvas.height-300, w:120, h:16, visible:false};

/* moving laser */
let laser = {x:0, y:canvas.height-200, w:200, h:6, dir:1};

/* portal */
let portal = {x:1040, y:canvas.height-500, w:60, h:90};

/* ---------- COLLISION ---------- */
function hit(a,b){
  return a.x < b.x+b.w &&
         a.x+a.w > b.x &&
         a.y < b.y+b.h &&
         a.y+a.h > b.y;
}

function onGround(){
  let test = {...player, y:player.y+1};
  return [...platforms, fakePlatform, trollPlatform]
    .filter(p=>p && (p.visible!==false) && (p.active!==false))
    .some(p=>hit(test,p));
}

/* ---------- DEATH ---------- */
function die(){
  deaths++;
  laughTimer = 50;
  if(!firstDeath) firstDeath = true;
  resetPlayer();
}

/* ---------- UPDATE ---------- */
function update(){

  if(win) return;

  /* movement */
  player.vx = 0;
  if(keys["ArrowLeft"]) player.vx = -5;
  if(keys["ArrowRight"]) player.vx = 5;
  if(keys["ArrowUp"] && onGround()) player.vy = jumpPower;

  player.vy += gravity;

  /* horizontal */
  player.x += player.vx;
  [...platforms, fakePlatform, trollPlatform].forEach(p=>{
    if(!p || p.visible===false || p.active===false) return;
    if(hit(player,p)){
      if(player.vx>0) player.x = p.x-player.w;
      if(player.vx<0) player.x = p.x+p.w;
    }
  });

  /* vertical */
  player.y += player.vy;
  [...platforms, fakePlatform, trollPlatform].forEach(p=>{
    if(!p || p.visible===false || p.active===false) return;
    if(hit(player,p)){
      if(player.vy>0){ player.y = p.y-player.h; player.vy=0; }
      if(player.vy<0){ player.y = p.y+p.h; player.vy=0; }
    }
  });

  /* fake platform disappears after step */
  if(fakePlatform.active && hit(player,fakePlatform)){
    setTimeout(()=> fakePlatform.active=false, 400);
  }

  /* troll platform appears near jump */
  if(!trollPlatform.visible && player.x > 600){
    trollPlatform.visible = true;
  }

  /* moving laser */
  laser.x += 3 * laser.dir;
  if(laser.x < 200 || laser.x > 700) laser.dir *= -1;

  if(hit(player,laser)) die();

  /* fall */
  if(player.y > canvas.height) die();

  /* portal */
  if(hit(player,portal)) win = true;

  if(laughTimer>0) laughTimer--;
}

/* ---------- DRAW FACE (EXTREME) ---------- */
function drawFace(){

  let x = canvas.width - 200;
  let y = 140;
  let laughing = laughTimer > 0;

  /* red glow */
  let g = ctx.createRadialGradient(x,y,20,x,y,120);
  g.addColorStop(0,"rgba(255,0,0,0.7)");
  g.addColorStop(1,"rgba(0,0,0,0)");
  ctx.fillStyle = g;
  ctx.beginPath();
  ctx.arc(x,y,120,0,Math.PI*2);
  ctx.fill();

  ctx.strokeStyle = "red";
  ctx.lineWidth = 3;

  /* eyes */
  if(laughing){
    ctx.beginPath();
    ctx.moveTo(x-40,y-10); ctx.lineTo(x-10,y-5);
    ctx.moveTo(x+10,y-5); ctx.lineTo(x+40,y-10);
    ctx.stroke();
  }else{
    ctx.strokeRect(x-40,y-25,20,15);
    ctx.strokeRect(x+20,y-25,20,15);
  }

  /* mouth */
  ctx.beginPath();
  if(laughing){
    ctx.arc(x,y+15,25,0,Math.PI);
  }else{
    ctx.arc(x,y+25,20,Math.PI,0);
  }
  ctx.stroke();

  /* YOUR ORIGINAL TEXT (exact words kept) */
  ctx.fillStyle="white";
  ctx.font="18px Arial";

  if(!firstDeath){
    ctx.fillText("Just a simple space person game", x-150, y+80);
  }
  else if(firstDeath && deaths === 1){
    ctx.fillText("Nah, it is not that much simple but you can do it", x-210, y+80);
  }
}


/* ---------- DRAW ---------- */
function draw(){

  ctx.clearRect(0,0,canvas.width,canv
  /* platforms */
  ctx.fillStyle="#00d4ff";
  platforms.forEach(p=>ctx.fillRect(p.x,p.y,p.w,p.h));
as.height);

  if(fakePlatform.active){
    ctx.fillStyle="orange";
    ctx.fillRect(fakePlatform.x,fakePlatform.y,fakePlatform.w,fakePlatform.h);
  }

  if(trollPlatform.visible){
    ctx.fillStyle="purple";
    ctx.fillRect(trollPlatform.x,trollPlatform.y,trollPlatform.w,trollPlatform.h);
  }

  /* laser */
  ctx.fillStyle="red";
  ctx.fillRect(laser.x, laser.y, laser.w, laser.h);

  /* portal */
  let grad = ctx.createRadialGradient(
    portal.x+30, portal.y+45, 5,
    portal.x+30, portal.y+45, 40
  );
  grad.addColorStop(0,"white");
  grad.addColorStop(0.5,"violet");
  grad.addColorStop(1,"black");
  ctx.fillStyle=grad;
  ctx.beginPath();
  ctx.ellipse(portal.x+30,portal.y+45,30,45,0,0,Math.PI*2);
  ctx.fill();

  /* player */
 // body
ctx.fillStyle="#06d6a0";
ctx.fillRect(player.x, player.y+10, player.w, player.h-10);

// head
ctx.fillStyle="#ffd166";
ctx.fillRect(player.x+6, player.y, player.w-12, 10);

// legs
ctx.fillStyle="#118ab2";
ctx.fillRect(player.x+2, player.y+player.h-6, 8, 6);
ctx.fillRect(player.x+player.w-10, player.y+player.h-6, 8, 6);


  drawFace();

  /* UI */
  ctx.fillStyle="white";
  ctx.font="18px Arial";
  ctx.fillText("Deaths: "+deaths, 20,30);
  ctx.fillText("Time: "+((Date.now()-startTime)/1000).toFixed(1), 20,55);

  if(win){
    ctx.font="48px Arial";
    ctx.fillText("YOU ESCAPED ðŸ˜ˆ,but there are more", canvas.width/2-160, canvas.height/2);
  }
}

/* ---------- LOOP ---------- */
function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>




</body>
</html>
